@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root,
  .dark {
    /* Core backgrounds */
    --background: 240 8% 11%; /* #1a1a1e - Deep Background */
    --foreground: 0 0% 100%; /* #ffffff - Text Primary */

    /* Panel/Card hierarchy */
    --panel: 240 4% 15%; /* #252528 - Panel Background */
    --card: 240 5% 19%; /* #2d2d32 - Card Surface */

    /* Muted/Secondary text */
    --muted: 240 4% 15%; /* Same as panel for backgrounds */
    --muted-foreground: 218 11% 65%; /* #9ca3af - Text Secondary */

    /* Border */
    --border: 240 5% 24%; /* #3a3a40 - Border Subtle */

    /* Accent (purple - primary interactive) */
    --accent: 258 90% 66%; /* #8b5cf6 - Accent Purple */
    --accent-foreground: 0 0% 100%;

    /* Accent variations */
    --accent-orange: 25 95% 53%; /* #f97316 - Waveforms, audio */
    --accent-yellow: 43 96% 56%; /* #fbbf24 - Markers, keyframes */

    /* Success */
    --success: 142 71% 45%; /* #22c55e - Success states */
    --success-foreground: 0 0% 100%;

    /* Destructive */
    --destructive: 0 84% 60%; /* #ef4444 - Destructive actions */
    --destructive-foreground: 0 0% 100%;

    /* Ring/Focus */
    --ring: 258 90% 66%; /* Match accent purple for focus rings */

    /* Timeline-specific tokens */
    --timeline-playhead: 0 84% 60%; /* Destructive red */
    --timeline-selection: 258 90% 66%; /* Accent purple */
    --timeline-slice: 240 5% 24%; /* Border subtle */
    --timeline-slice-selected: 258 90% 66%; /* Accent purple */
    --timeline-waveform: 25 95% 53%; /* Accent orange for waveforms */

    --radius: 0.5rem;
  }
}

@layer base {
  /* Apply border color to elements, but NOT in toolbar */
  body.editor-window * {
    @apply border-border;
  }

  html,
  body,
  #root {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  body {
    @apply bg-background text-foreground;
    font-family:
      -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
      Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  }

  /* Toolbar window - transparent, no scrollbars */
  body.toolbar-window,
  body.toolbar-window #root {
    background: transparent !important;
    overflow: hidden !important;
  }

  /* Editor window - solid background */
  body.editor-window,
  body.editor-window #root {
    @apply bg-background;
    overflow: hidden;
  }

  /* Hide scrollbars for toolbar window */
  body.toolbar-window ::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
  }

  /* Prevent text selection during drag operations */
  .no-select {
    user-select: none;
    -webkit-user-select: none;
  }

  /* Custom scrollbar for editor */
  body.editor-window ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  body.editor-window ::-webkit-scrollbar-track {
    @apply bg-muted;
  }

  body.editor-window ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/30 rounded-full;
  }

  body.editor-window ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground/50;
  }
}

/* Toolbar Window Styles */
@layer components {
  /* Reset Tailwind preflight border styles for entire toolbar */
  .toolbar-container,
  .toolbar-container *,
  .toolbar-container *::before,
  .toolbar-container *::after {
    border: 0 solid transparent !important;
    border-color: transparent !important;
    outline: none !important;
  }

  .toolbar-container {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    background: transparent !important;
    padding: 4px 8px;
    box-sizing: border-box;
  }

  .toolbar-content {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 12px;
    border-radius: 16px;
    background: rgba(30, 30, 30, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: none;
    white-space: nowrap;
    flex-shrink: 0;
    /* Subtle rounded border */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    outline: none !important;
    outline-width: 0 !important;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }

  .drag-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4px 6px;
    color: rgba(255, 255, 255, 0.3);
    cursor: grab;
    flex-shrink: 0;
    -webkit-app-region: drag;
    border: none !important;
  }

  .drag-handle:active {
    cursor: grabbing;
  }

  .drag-handle:hover {
    color: rgba(255, 255, 255, 0.5);
  }

  .toolbar-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    border-radius: 8px;
    color: rgba(255, 255, 255, 0.7);
    transition: all 0.15s ease;
    white-space: nowrap;
    flex-shrink: 0;
    border: none !important;
    background: transparent;
    cursor: pointer;
  }

  .toolbar-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  .toolbar-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .toolbar-btn:disabled:hover {
    background: transparent;
  }

  .toolbar-btn.active {
    background: rgba(255, 255, 255, 0.15);
    color: white;
  }

  .toolbar-btn-sm {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    color: rgba(255, 255, 255, 0.7);
    transition: all 0.15s ease;
    border: none !important;
    background: transparent;
    cursor: pointer;
    flex-shrink: 0;
  }

  .toolbar-btn-sm:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  .toolbar-btn-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    color: rgba(255, 255, 255, 0.5);
    transition: all 0.15s ease;
    border: none !important;
    background: transparent;
    cursor: pointer;
    flex-shrink: 0;
  }

  .toolbar-btn-icon:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  .toolbar-btn-icon.close:hover {
    background: rgba(239, 68, 68, 0.2);
    color: rgb(248, 113, 113);
  }

  .toolbar-divider {
    width: 1px;
    height: 20px;
    background: rgba(255, 255, 255, 0.1);
    flex-shrink: 0;
  }

  .dropdown-trigger {
    margin-left: 2px;
    padding: 2px;
    border-radius: 4px;
    border: none;
    background: transparent;
    color: inherit;
    cursor: pointer;
    transition: background 0.15s ease;
  }

  .dropdown-trigger:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  .dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 8px;
    min-width: 200px;
    padding: 4px 0;
    border-radius: 12px;
    z-index: 9999;
    background: rgba(26, 26, 26, 0.98);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.15) !important;
    border-color: rgba(255, 255, 255, 0.15) !important;
    border-style: solid !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  }

  .dropdown-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 8px 12px;
    text-align: left;
    font-size: 13px;
    color: rgba(255, 255, 255, 0.7);
    transition: all 0.15s ease;
    border: none;
    background: transparent;
    cursor: pointer;
  }

  .dropdown-item:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  .dropdown-item.active {
    background: transparent !important;
    color: white;
  }

  .record-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 8px;
    font-weight: 500;
    font-size: 13px;
    transition: all 0.15s ease;
    background: rgb(239, 68, 68);
    color: white;
    border: none;
    cursor: pointer;
    flex-shrink: 0;
  }

  .record-btn:hover {
    background: rgb(220, 38, 38);
  }

  .record-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .record-btn:disabled:hover {
    background: rgb(239, 68, 68);
  }

  .stop-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    transition: all 0.15s ease;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: none;
    cursor: pointer;
    flex-shrink: 0;
  }

  .stop-btn:hover {
    background: rgba(239, 68, 68, 0.8);
  }

  .stop-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .recording-timer {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 4px 10px;
    border-radius: 6px;
    background: rgba(0, 0, 0, 0.3);
    color: white;
    font-family: ui-monospace, monospace;
    font-size: 13px;
  }

  .recording-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgb(239, 68, 68);
    animation: pulse 1.5s ease-in-out infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  /* Post-Recording Popup */
  .popup-container {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    background: transparent !important;
    padding: 4px 40px;
    box-sizing: border-box;
  }

  .popup-content {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 12px 16px;
    padding-right: 40px;
    border-radius: 16px;
    background: rgba(30, 30, 30, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    position: relative;
    border: none !important;
  }

  .popup-preview {
    border-radius: 8px;
    overflow: hidden;
    background: rgba(0, 0, 0, 0.5);
    flex-shrink: 0;
  }

  .popup-video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    background: #111;
  }

  .popup-video-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.5);
  }

  .popup-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .popup-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s ease;
    border: none;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    white-space: nowrap;
  }

  .popup-btn:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  .popup-btn-primary {
    background: rgb(99, 102, 241);
  }

  .popup-btn-primary:hover {
    background: rgb(79, 82, 221);
  }

  .popup-btn-disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .popup-btn-disabled:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  .popup-info {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
    white-space: nowrap;
  }

  .popup-close {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.15s ease;
  }

  .popup-close:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }
}
